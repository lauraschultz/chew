{"ast":null,"code":"var _jsxFileName = \"/Users/lauraschultz/Documents/projects/yelp-restaurant-chooser/client/src/Filters.tsx\";\nimport { faExclamationCircle, faSlidersH } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport React, { useEffect, useReducer, useState } from \"react\";\n\nconst Filters = ({\n  update,\n  updateSearchFormState,\n  searchFormFilterState\n}) => {\n  const initialForm = {\n    openDate: \"any\",\n    openNow: false,\n    prices: [0, 3],\n    services: {\n      pickup: true,\n      delivery: true,\n      restaurant_reservation: true\n    }\n  };\n  let [showFilters, setShowFilters] = useState(false); // let location = useLocation();\n  // let history = useHistory()\n\n  const [state, dispatch] = useReducer(formReducer, searchFormFilterState || initialForm); //   let [[price1, price2], setPrices] = useState<(number | undefined)[]>([0, 3]);\n  // let onlyOnePriceSet: boolean;\n\n  useEffect(() => {\n    updateSearchFormState({\n      filter: state\n    });\n  }, [state, updateSearchFormState]); // useEffect(() => {\n  //   onlyOnePriceSet = !(state.prices[0]! > -1 && state.prices[1]! > -1);\n  // }, [state.prices]);\n\n  const min = arr => {\n    let min = 99;\n    arr.forEach(n => {\n      if (typeof n === \"number\" && n < min) {\n        min = n;\n      }\n    });\n    return min;\n  };\n\n  useEffect(() => {\n    update({\n      openHours: state.openDate === \"any\" ? \"any\" : state.openNow ? \"now\" : \"today\",\n      priceRange: new Array(state.prices[1] === undefined ? 1 : Math.abs(state.prices[0] - state.prices[1]) + 1).fill(0).map((_, idx) => min(state.prices) + 1 + idx).join(\",\"),\n      services: Object.entries(state.services).filter(([_, b]) => b).map(([e, _]) => e).join(\",\")\n    });\n  }, [state, update]);\n\n  const isBetween = (n, stops) => {\n    if (!(typeof stops[0] === \"number\" && typeof stops[1] === \"number\")) {\n      return false;\n    }\n\n    return stops[0] < n && n < stops[1] || stops[1] < n && n < stops[0];\n  };\n\n  const priceArray = new Array(4).fill(\"\").map((a, b) => \"$\".repeat(b + 1));\n  const selectedPriceStyles = \"bg-theme-blue text-white px-1 py-2 rounded-full z-30 \";\n  const intermediatePriceStyles = \"bg-theme-blue-l-3 text-black py-1 px-4 -mx-2 z-20 \";\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"m-1 px-2 py-1 text-theme-blue border border-theme-blue bg-white rounded shadow font-bold text-sm uppercase tracking-wide\",\n    onClick: () => setShowFilters(!showFilters),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faSlidersH,\n    className: \"mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 9\n    }\n  }), showFilters ? \"hide\" : \"show\", \" filters\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"px-2 pb-2 flex flex-wrap border-b border-theme-extra-light-gray \" + (showFilters ? \"\" : \"hidden\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full sm:w-1/2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-sm font-bold uppercase tracking-wide text-theme-med-gray\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 11\n    }\n  }, \"Price Range\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"group mt-1 ml-2 mb-3 text-sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }, priceArray.map((d, idx) => /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    key: idx,\n    onClick: () => dispatch({\n      key: \"price\",\n      newVal: idx\n    }),\n    className: \"relative px-2 \" + (state.prices.includes(idx) ? selectedPriceStyles : \"\") + (isBetween(idx, state.prices) ? intermediatePriceStyles : \"\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 15\n    }\n  }, d))), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-sm font-bold uppercase tracking-wide text-theme-med-gray\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 11\n    }\n  }, \"Open Hours\"), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"block px-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"mr-1\",\n    checked: state.openDate === \"any\",\n    type: \"radio\",\n    name: \"day\",\n    onChange: () => dispatch({\n      newVal: \"any\",\n      key: \"openDate\"\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }\n  }), \"Any time\"), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"block px-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"mr-1\",\n    checked: state.openDate === \"today\",\n    type: \"radio\",\n    name: \"day\",\n    onChange: () => dispatch({\n      newVal: \"today\",\n      key: \"openDate\"\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 13\n    }\n  }), \"Today\", /*#__PURE__*/React.createElement(\"label\", {\n    className: \"block px-4 -mt-1 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"mr-1\",\n    checked: state.openNow,\n    type: \"checkbox\",\n    onChange: () => dispatch({\n      key: \"openNow\"\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 15\n    }\n  }), \"Open now\"))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w-full sm:w-1/2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"text-sm font-bold uppercase tracking-wide text-theme-med-gray\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 11\n    }\n  }, \"Services Offered\"), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"block px-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"mr-1\",\n    checked: state.services.pickup,\n    type: \"checkbox\",\n    onChange: () => dispatch({\n      key: \"pickup\"\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }), \"Pickup\"), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"block px-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"mr-1\",\n    checked: state.services.delivery,\n    type: \"checkbox\",\n    onChange: () => dispatch({\n      key: \"delivery\"\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }\n  }), \"Delivery\"), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"block px-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: \"mr-1\",\n    checked: state.services.restaurant_reservation,\n    type: \"checkbox\",\n    onChange: () => dispatch({\n      key: \"restaurant_reservation\"\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }), \"Restaurant reservation\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: !(state.services.pickup || state.services.delivery || state.services.restaurant_reservation) ? \"mx-6 my-1 bg-white bg-opacity-50 border-l-4 border-orange-500 px-2 py-1 rounded text-sm italic\" : \"hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(FontAwesomeIcon, {\n    icon: faExclamationCircle,\n    className: \"text-orange-500 mr-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  }), \"Please select at least one service.\"))));\n};\n\nfunction formReducer(prevState, update) {\n  const stateUpdates = {};\n\n  if (update.key === \"openDate\") {\n    if (update.newVal === \"any\") {\n      stateUpdates.openDate = \"any\";\n      stateUpdates.openNow = false;\n    } else {\n      stateUpdates.openDate = \"today\";\n    }\n  } else if (update.key === \"openNow\") {\n    stateUpdates.openNow = !prevState.openNow;\n\n    if (stateUpdates.openNow) {\n      stateUpdates.openDate = \"today\";\n    }\n  } else if (update.key === \"delivery\" || update.key === \"pickup\" || update.key === \"restaurant_reservation\") {\n    stateUpdates.services = { ...prevState.services,\n      [update.key]: !prevState.services[update.key]\n    };\n  } else if (update.key === \"price\") {\n    if (typeof prevState.prices[0] === \"number\" && typeof prevState.prices[1] === \"number\") {\n      stateUpdates.prices = [update.newVal, undefined];\n    } else if (typeof prevState.prices[0] === \"number\") {\n      stateUpdates.prices = [prevState.prices[0], update.newVal];\n    }\n  }\n\n  const newState = { ...prevState,\n    ...stateUpdates\n  }; // window.history.replaceState({\n  //   ...window.history.state,\n  //   filter: JSON.stringify(newState)\n  // }, \"\")\n\n  return newState;\n}\n\nexport default Filters;","map":{"version":3,"sources":["/Users/lauraschultz/Documents/projects/yelp-restaurant-chooser/client/src/Filters.tsx"],"names":["faExclamationCircle","faSlidersH","FontAwesomeIcon","React","useEffect","useReducer","useState","Filters","update","updateSearchFormState","searchFormFilterState","initialForm","openDate","openNow","prices","services","pickup","delivery","restaurant_reservation","showFilters","setShowFilters","state","dispatch","formReducer","filter","min","arr","forEach","n","openHours","priceRange","Array","undefined","Math","abs","fill","map","_","idx","join","Object","entries","b","e","isBetween","stops","priceArray","a","repeat","selectedPriceStyles","intermediatePriceStyles","d","key","newVal","includes","prevState","stateUpdates","newState"],"mappings":"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","sourcesContent":["import {\n  faExclamationCircle,\n  faSlidersH,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport React, { useEffect, useReducer, useState } from \"react\";\nimport { FilterResults } from \"./Search\";\nimport { SearchFormState } from \"./Templates/AppTemplate\";\nimport { FilterForm } from \"./YelpInterfaces\";\n\nconst Filters: React.FC<{\n  update: (newFilters: FilterResults) => void;\n  updateSearchFormState: (s: Partial<SearchFormState>) => void;\n  searchFormFilterState?: FilterForm\n}> = ({ update, updateSearchFormState, searchFormFilterState }) => {\n  const initialForm: FilterForm = {\n    openDate: \"any\",\n    openNow: false,\n    prices: [0, 3],\n    services: {\n      pickup: true,\n      delivery: true,\n      restaurant_reservation: true,\n    },\n  };\n  let [showFilters, setShowFilters] = useState(false);\n  // let location = useLocation();\n  // let history = useHistory()\n  const [state, dispatch] = useReducer(formReducer, searchFormFilterState || initialForm);\n  //   let [[price1, price2], setPrices] = useState<(number | undefined)[]>([0, 3]);\n  // let onlyOnePriceSet: boolean;\n\n  useEffect(() => {\n    updateSearchFormState({filter: state});\n  }, [state, updateSearchFormState]);\n\n  // useEffect(() => {\n  //   onlyOnePriceSet = !(state.prices[0]! > -1 && state.prices[1]! > -1);\n  // }, [state.prices]);\n\n  const min = (arr: (number | undefined)[]) => {\n    let min = 99;\n    arr.forEach((n) => {\n      if (typeof n === \"number\" && n < min) {\n        min = n;\n      }\n    });\n    return min;\n  };\n\n  useEffect(() => {\n    update({\n      openHours:\n        state.openDate === \"any\" ? \"any\" : state.openNow ? \"now\" : \"today\",\n      priceRange: new Array(\n        state.prices[1] === undefined\n          ? 1\n          : Math.abs(state.prices[0]! - state.prices[1]!) + 1\n      )\n        .fill(0)\n        .map((_, idx) => min(state.prices) + 1 + idx)\n        .join(\",\"),\n      services: Object.entries(state.services)\n        .filter(([_, b]) => b)\n        .map(([e, _]) => e)\n        .join(\",\"),\n    });\n  }, [state, update]);\n\n  const isBetween = (n: number, stops: (number | undefined)[]) => {\n    if (!(typeof stops[0] === \"number\" && typeof stops[1] === \"number\")) {\n      return false;\n    }\n    return (stops[0] < n && n < stops[1]) || (stops[1] < n && n < stops[0]);\n  };\n  const priceArray = new Array(4).fill(\"\").map((a, b) => \"$\".repeat(b + 1));\n  const selectedPriceStyles =\n    \"bg-theme-blue text-white px-1 py-2 rounded-full z-30 \";\n  const intermediatePriceStyles =\n    \"bg-theme-blue-l-3 text-black py-1 px-4 -mx-2 z-20 \";\n\n  return (\n    <>\n      <button\n        type=\"button\"\n        className=\"m-1 px-2 py-1 text-theme-blue border border-theme-blue bg-white rounded shadow font-bold text-sm uppercase tracking-wide\"\n        onClick={() => setShowFilters(!showFilters)}\n      >\n        <FontAwesomeIcon icon={faSlidersH} className=\"mr-2\" />\n        {showFilters ? \"hide\" : \"show\"} filters\n      </button>\n      <div\n        className={\n          \"px-2 pb-2 flex flex-wrap border-b border-theme-extra-light-gray \" +\n          (showFilters ? \"\" : \"hidden\")\n        }\n      >\n        <div className=\"w-full sm:w-1/2\">\n          <span className=\"text-sm font-bold uppercase tracking-wide text-theme-med-gray\">\n            Price Range\n          </span>\n\n          <div className=\"group mt-1 ml-2 mb-3 text-sm\">\n            {priceArray.map((d, idx) => (\n              <button\n                type=\"button\"\n                key={idx}\n                onClick={() => dispatch({ key: \"price\", newVal: idx })}\n                className={\n                  \"relative px-2 \" +\n                  (state.prices.includes(idx) ? selectedPriceStyles : \"\") +\n                  (isBetween(idx, state.prices) ? intermediatePriceStyles : \"\")\n                }\n              >\n                {d}\n              </button>\n            ))}\n          </div>\n          <span className=\"text-sm font-bold uppercase tracking-wide text-theme-med-gray\">\n            Open Hours\n          </span>\n          <label className=\"block px-2\">\n            <input\n              className=\"mr-1\"\n              checked={state.openDate === \"any\"}\n              type=\"radio\"\n              name=\"day\"\n              onChange={() => dispatch({ newVal: \"any\", key: \"openDate\" })}\n            />\n            Any time\n          </label>\n          <label className=\"block px-2\">\n            <input\n              className=\"mr-1\"\n              checked={state.openDate === \"today\"}\n              type=\"radio\"\n              name=\"day\"\n              onChange={() => dispatch({ newVal: \"today\", key: \"openDate\" })}\n            />\n            Today\n            <label className=\"block px-4 -mt-1 mb-2\">\n              <input\n                className=\"mr-1\"\n                checked={state.openNow}\n                type=\"checkbox\"\n                onChange={() => dispatch({ key: \"openNow\" })}\n              />\n              Open now\n            </label>\n          </label>\n        </div>\n        <div className=\"w-full sm:w-1/2\">\n          <span className=\"text-sm font-bold uppercase tracking-wide text-theme-med-gray\">\n            Services Offered\n          </span>\n          <label className=\"block px-2\">\n            <input\n              className=\"mr-1\"\n              checked={state.services.pickup}\n              type=\"checkbox\"\n              onChange={() => dispatch({ key: \"pickup\" })}\n            />\n            Pickup\n          </label>\n          <label className=\"block px-2\">\n            <input\n              className=\"mr-1\"\n              checked={state.services.delivery}\n              type=\"checkbox\"\n              onChange={() => dispatch({ key: \"delivery\" })}\n            />\n            Delivery\n          </label>\n          <label className=\"block px-2\">\n            <input\n              className=\"mr-1\"\n              checked={state.services.restaurant_reservation}\n              type=\"checkbox\"\n              onChange={() => dispatch({ key: \"restaurant_reservation\" })}\n            />\n            Restaurant reservation\n          </label>\n          <div\n            className={\n              !(\n                state.services.pickup ||\n                state.services.delivery ||\n                state.services.restaurant_reservation\n              )\n                ? \"mx-6 my-1 bg-white bg-opacity-50 border-l-4 border-orange-500 px-2 py-1 rounded text-sm italic\"\n                : \"hidden\"\n            }\n          >\n            <FontAwesomeIcon\n              icon={faExclamationCircle}\n              className=\"text-orange-500 mr-2\"\n            />\n            Please select at least one service.\n          </div>\n        </div>\n      </div>\n    </>\n  );\n};\n\nfunction formReducer(\n  prevState: FilterForm,\n  update: { newVal?: any; key: string }\n): FilterForm {\n  const stateUpdates: Partial<FilterForm> = {};\n  if (update.key === \"openDate\") {\n    if (update.newVal === \"any\") {\n      stateUpdates.openDate = \"any\";\n      stateUpdates.openNow = false;\n    } else {\n      stateUpdates.openDate = \"today\";\n    }\n  } else if (update.key === \"openNow\") {\n    stateUpdates.openNow = !prevState.openNow;\n    if (stateUpdates.openNow) {\n      stateUpdates.openDate = \"today\";\n    }\n  } else if (\n    update.key === \"delivery\" ||\n    update.key === \"pickup\" ||\n    update.key === \"restaurant_reservation\"\n  ) {\n    stateUpdates.services = {\n      ...prevState.services,\n      [update.key]: !prevState.services[update.key],\n    };\n  } else if (update.key === \"price\") {\n    if (\n      typeof prevState.prices[0] === \"number\" &&\n      typeof prevState.prices[1] === \"number\"\n    ) {\n      stateUpdates.prices = [update.newVal, undefined];\n    } else if (typeof prevState.prices[0] === \"number\") {\n      stateUpdates.prices = [prevState.prices[0], update.newVal];\n    }\n  }\n  const newState = { ...prevState, ...stateUpdates };\n\n  // window.history.replaceState({\n  //   ...window.history.state,\n  //   filter: JSON.stringify(newState)\n  // }, \"\")\n  return newState;\n}\n\nexport default Filters;\n"]},"metadata":{},"sourceType":"module"}