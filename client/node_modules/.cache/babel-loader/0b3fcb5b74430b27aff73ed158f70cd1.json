{"ast":null,"code":"import _classCallCheck from\"/Users/lauraschultz/Documents/projects/yelp-restaurant-chooser/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import io from\"socket.io-client\";import axios from\"axios\";import{SERVER}from\"./config\";export var Socket=function Socket(){var _this=this;_classCallCheck(this,Socket);this.socket=void 0;this.search=function(sessionId,searchTerm,openHours,priceRange,services){return new Promise(function(resolve,reject){return axios.get(\"\".concat(SERVER,\"/search/\").concat(sessionId,\"/\").concat(searchTerm,\"/\").concat(openHours,\"/\").concat(priceRange,\"/\").concat(services)).then(function(result){return resolve(result.data);});});};this.setUserName=function(sessionId,userId,userName){return new Promise(function(resolve,reject){return axios.post(\"\".concat(SERVER,\"/setUserName/\").concat(sessionId,\"/\").concat(userId,\"/\").concat(userName)).then(function(result){return resolve(result.data);}).catch(function(){return console.log(\"error\");});});};this.addVote=function(sessionId,userId,restaurantId,voteNum){return new Promise(function(resolve,reject){return axios.post(\"\".concat(SERVER,\"/addVote/\").concat(sessionId,\"/\").concat(userId,\"/\").concat(restaurantId,\"/\").concat(voteNum)).then(function(result){return resolve(result.data);});});};this.addRestaurant=function(sessionId,userId,restaurantId){return new Promise(function(resolve,reject){return axios.post(\"\".concat(SERVER,\"/addRestaurant/\").concat(sessionId,\"/\").concat(userId,\"/\").concat(restaurantId)).then(function(result){return resolve(result.data);});});};this.emit=function(data,callback,title){console.log(\"socket emitting \".concat(title,\" with data \").concat(JSON.stringify(data)));_this.socket.emit(title,data,callback);};this.newSession=function(data,callback){_this.emit(data,callback,\"newSession\");};this.tryJoinSession=function(data,callback){_this.emit(data,callback,\"tryJoinSession\");};this.subscribeToVoteAdded=function(callback){_this.socket.on(\"addedVote\",callback);};this.unSubscribeToVoteAdded=function(){_this.socket.off(\"addedVote\");};this.subscribeToRestaurantAdded=function(callback){_this.socket.on(\"addedRestaurant\",callback);};this.unSubscribeToRestaurantAdded=function(){_this.socket.off(\"addedRestaurant\");};console.log(\"running socket constructor.\");this.socket=io.connect(SERVER);};var socket=new Socket();console.log(\"here.\");export default socket;","map":{"version":3,"sources":["/Users/lauraschultz/Documents/projects/yelp-restaurant-chooser/client/src/socket.ts"],"names":["io","axios","SERVER","Socket","socket","search","sessionId","searchTerm","openHours","priceRange","services","Promise","resolve","reject","get","then","result","data","setUserName","userId","userName","post","catch","console","log","addVote","restaurantId","voteNum","addRestaurant","emit","callback","title","JSON","stringify","newSession","tryJoinSession","subscribeToVoteAdded","on","unSubscribeToVoteAdded","off","subscribeToRestaurantAdded","unSubscribeToRestaurantAdded","connect"],"mappings":"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","sourcesContent":["import io from \"socket.io-client\";\nimport {\n  NewSessionData,\n  NewSessionCallback,\n  TryJoinSessionData,\n  TryJoinSessionCallback,\n  Business,\n} from \"../../shared/types\";\nimport axios from \"axios\";\nimport { SERVER } from \"./config\";\n\nexport class Socket {\n  socket: SocketIOClient.Socket;\n\n  constructor() {\n    console.log(`running socket constructor.`)\n    this.socket = io.connect(SERVER);\n  }\n\n  search = (sessionId: string, searchTerm: string, openHours:string, priceRange:string, services:string): Promise<Business[]> =>\n    new Promise((resolve, reject) =>\n      axios\n        .get(`${SERVER}/search/${sessionId}/${searchTerm}/${openHours}/${priceRange}/${services}`)\n        .then((result) => resolve(result.data))\n    );\n\n  setUserName = (\n    sessionId: string,\n    userId: string,\n    userName: string\n  ): Promise<boolean> =>\n    new Promise((resolve, reject) =>\n      axios\n        .post(`${SERVER}/setUserName/${sessionId}/${userId}/${userName}`)\n        .then((result) => resolve(result.data))\n        .catch(() => console.log(`error`))\n    );\n\n  addVote = (\n    sessionId: string,\n    userId: string,\n    restaurantId: string,\n    voteNum: number\n  ): Promise<boolean> =>\n    new Promise((resolve, reject) =>\n      axios\n        .post(\n          `${SERVER}/addVote/${sessionId}/${userId}/${restaurantId}/${voteNum}`\n        )\n        .then((result) => resolve(result.data))\n    );\n\n  addRestaurant = (\n    sessionId: string,\n    userId: string,\n    restaurantId: string\n  ): Promise<boolean> =>\n    new Promise((resolve, reject) =>\n      axios\n        .post(`${SERVER}/addRestaurant/${sessionId}/${userId}/${restaurantId}`)\n        .then((result) => resolve(result.data))\n    );\n\n  emit = (data: any, callback: (p: any) => void, title: string) => {\n    console.log(`socket emitting ${title} with data ${JSON.stringify(data)}`);\n    this.socket.emit(title, data, callback);\n  };\n\n  newSession: (data: NewSessionData, callback: NewSessionCallback) => void = (\n    data,\n    callback\n  ) => {\n    this.emit(data, callback, \"newSession\");\n  };\n\n  tryJoinSession: (\n    data: TryJoinSessionData,\n    callback: TryJoinSessionCallback\n  ) => void = (data, callback) => {\n    this.emit(data, callback, \"tryJoinSession\");\n  };\n\n  subscribeToVoteAdded = (callback: Function) => {\n    this.socket.on(\"addedVote\", callback);\n  };\n\n  unSubscribeToVoteAdded = () => {\n    this.socket.off(\"addedVote\")\n  }  \n\n  subscribeToRestaurantAdded = (callback: Function) => {\n    this.socket.on(\"addedRestaurant\", callback);\n  };\n\n  unSubscribeToRestaurantAdded = () => {\n    this.socket.off(\"addedRestaurant\")\n  }\n}\n\n\n\nlet socket = new Socket();\nconsole.log(\"here.\");\nexport default socket;\n"]},"metadata":{},"sourceType":"module"}