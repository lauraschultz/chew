(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[3],{131:function(e,t,a){"use strict";e.exports=function(e,t,a,n,r,s,o,c){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var i=[a,n,r,s,o,c],u=0;(l=new Error(t.replace(/%s/g,(function(){return i[u++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},132:function(e,t,a){var n=a(133),r=function(e){var t="",a=Object.keys(e);return a.forEach((function(r,s){var o=e[r];(function(e){return/[height|width]$/.test(e)})(r=n(r))&&"number"===typeof o&&(o+="px"),t+=!0===o?r:!1===o?"not "+r:"("+r+": "+o+")",s<a.length-1&&(t+=" and ")})),t};e.exports=function(e){var t="";return"string"===typeof e?e:e instanceof Array?(e.forEach((function(a,n){t+=r(a),n<e.length-1&&(t+=", ")})),t):r(e)}},133:function(e,t){e.exports=function(e){return e.replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()})).toLowerCase()}},134:function(e,t,a){"use strict";function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}a.r(t);var o=a(6),c=a(5),l=a(4),i=a(0),u=a.n(i),m=a(3),d=a(9);function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var p=a(1),h=a.n(p),y=a(131),v=a.n(y),g=a(132),x=a.n(g),E=function(){function e(e,t,a){var n=this;this.nativeMediaQueryList=e.matchMedia(t),this.active=!0,this.cancellableListener=function(){n.matches=n.nativeMediaQueryList.matches,n.active&&a.apply(void 0,arguments)},this.nativeMediaQueryList.addListener(this.cancellableListener),this.matches=this.nativeMediaQueryList.matches}return e.prototype.cancel=function(){this.active=!1,this.nativeMediaQueryList.removeListener(this.cancellableListener)},e}(),w=h.a.oneOfType([h.a.string,h.a.object,h.a.arrayOf(h.a.object.isRequired)]),N=function(e){function t(t){var a,n;return f(b(b(a=e.call(this,t)||this)),"queries",[]),f(b(b(a)),"getMatches",(function(){return function(e){var t=Object.keys(e);if(1===t.length&&"__DEFAULT__"===t[0])return e.__DEFAULT__;return e}(a.queries.reduce((function(e,t){var a,n=t.name,r=t.mqListener;return Object(m.a)({},e,((a={})[n]=r.matches,a))}),{}))})),f(b(b(a)),"updateMatches",(function(){var e=a.getMatches();a.setState((function(){return{matches:e}}),a.onChange)})),t.query||t.queries||t.query&&t.queries||v()(!1),void 0!==t.defaultMatches&&t.query&&"boolean"!==typeof t.defaultMatches&&v()(!1),void 0!==t.defaultMatches&&t.queries&&"object"!==typeof t.defaultMatches&&v()(!1),"object"!==typeof window?(n=void 0!==t.defaultMatches?t.defaultMatches:!!t.query||Object.keys(a.props.queries).reduce((function(e,t){var a;return Object(m.a)({},e,((a={})[t]=!0,a))}),{}),a.state={matches:n},b(a)):(a.initialize(),a.state={matches:void 0!==a.props.defaultMatches?a.props.defaultMatches:a.getMatches()},a.onChange(),a)}Object(d.a)(t,e);var a=t.prototype;return a.initialize=function(){var e=this,t=this.props.targetWindow||window;"function"!==typeof t.matchMedia&&v()(!1);var a=this.props.queries||{__DEFAULT__:this.props.query};this.queries=Object.keys(a).map((function(n){var r=a[n],s="string"!==typeof r?x()(r):r;return{name:n,mqListener:new E(t,s,e.updateMatches)}}))},a.componentDidMount=function(){this.initialize(),void 0!==this.props.defaultMatches&&this.updateMatches()},a.onChange=function(){var e=this.props.onChange;e&&e(this.state.matches)},a.componentWillUnmount=function(){this.queries.forEach((function(e){return e.mqListener.cancel()}))},a.render=function(){var e=this.props,t=e.children,a=e.render,n=this.state.matches,r="object"===typeof n?Object.keys(n).some((function(e){return n[e]})):n;return a?r?a(n):null:t?"function"===typeof t?t(n):(!Array.isArray(t)||t.length)&&r?u.a.Children.only(t)&&"string"===typeof u.a.Children.only(t).type?u.a.Children.only(t):u.a.cloneElement(u.a.Children.only(t),{matches:n}):null:null},t}(u.a.Component);f(N,"propTypes",{defaultMatches:h.a.oneOfType([h.a.bool,h.a.objectOf(h.a.bool)]),query:w,queries:h.a.objectOf(w),render:h.a.func,children:h.a.oneOfType([h.a.node,h.a.func]),targetWindow:h.a.object,onChange:h.a.func});var j=N,O=a(2),k=a(10),S=a(19),C=a(36),I=function(e){var t=e.sessionUrl,a=e.onClose;return u.a.createElement(C.a,{onClose:a},u.a.createElement("div",{className:"bg-white p-6 text-gray-800 text-lg"},"Scan this code to join the session:",u.a.createElement("img",{className:"mx-auto my-6",height:"174px",width:"174px",src:"https://api.qrserver.com/v1/create-qr-code/?format=svg&data=".concat(t,"&size=200x200"),alt:"QR code for session url"})))},R=function(e){var t=e.inputThemes,a=e.buttonThemes,n=e.buttonShadowColor,r=Object(i.useRef)(null),s=Object(i.useState)(!1),m=Object(o.a)(s,2),d=m[0],b=m[1],f=Object(i.useState)(!1),p=Object(o.a)(f,2),h=p[0],y=p[1];return u.a.createElement(u.a.Fragment,null,h&&u.a.createElement(I,{sessionUrl:window.location.href,onClose:function(){return y(!1)}}),u.a.createElement("div",{className:"w-max-content text-sm m-1"},u.a.createElement("label",{className:"sr-only",htmlFor:"url"},"url of this session"),u.a.createElement("input",{id:"url",type:"text",ref:r,readOnly:!0,className:"border rounded-l py-1 pl-2 w-32 overflow-hidden btn-focus text-sm "+t,value:window.location.href}),u.a.createElement("button",{"aria-label":d?"Copied!":"Copy to clipboard","data-balloon-pos":"up",className:"rounded-r py-1 px-2 border btn-focus ".concat(a),style:{boxShadow:"".concat(n," -5px 0 8px")},onClick:function(e){var t;null===(t=r.current)||void 0===t||t.select(),document.execCommand("copy"),b(!0)}},u.a.createElement(l.a,{icon:c.g}))),u.a.createElement("button",{className:"text-xs px-2 py-1 italic",onClick:function(){return y((function(e){return!e}))}},u.a.createElement(l.a,{icon:c.w,className:"mr-1.5"}),"show QR code"))},D=a.p+"static/media/waves.44ab1c06.svg",M=a(62),T=function(){return u.a.createElement("footer",{className:"text-red w-full mt-4"},u.a.createElement("img",{src:D,alt:"",className:" max-h-14 -mb-1"}),u.a.createElement("div",{className:"bg-red text-gray-50 p-2 md:px-4 lg:px-24 block sm:flex justify-around items-center leading-tight"},u.a.createElement("div",{className:"flex-initial p-2"},u.a.createElement("p",{className:"mb-1"},"Share this session with others:"),u.a.createElement(R,{buttonThemes:"bg-gray-50 text-red border-gray-50",buttonShadowColor:"#e8505b",inputThemes:"border-gray-50 bg-red"})),u.a.createElement("div",{className:"flex-initial p-2 text-xs"},u.a.createElement(M.a,null))))},V=function(e){var t=e.onClose;return u.a.createElement("div",{className:"px-6 py-4 text-gray-50 bg-gradient-to-r from-red to-red-dark rounded-t font-bold text-xl relative"},u.a.createElement("span",{className:""},"Welcome to"),u.a.createElement("img",{className:"inline w-24 ml-1 mr-6",src:S.a,alt:"chew logo"}),u.a.createElement("button",{className:"absolute top-0 right-0 m-3 leading-none btn-focus",onClick:t,"aria-label":"close modal"},u.a.createElement(l.a,{icon:c.B})))},q=function(e){var t=e.onClose;return u.a.createElement(u.a.Fragment,null,u.a.createElement(V,{onClose:t}),u.a.createElement("div",{className:"pb-4 pt-1 px-6 rounded-b bg-gray-50 text-gray-700"},"Share this url with others:",u.a.createElement("div",{className:"mt-1 mb-4 mx-auto w-max-content"},u.a.createElement(R,{buttonThemes:"bg-green-500 border-green-500 text-gray-50",buttonShadowColor:"white",inputThemes:"border-gray-300"})),u.a.createElement("button",{onClick:t,className:"py-1 uppercase tracking-wide text-sm border border-gray-700 w-full mt-2 rounded shadow font-bold btn-focus","aria-label":"dismiss"},"dismiss")))},A=a(35),F=function(e){var t=e.show,a=e.children;return u.a.createElement("div",{className:"fixed z-50 right-0 bottom-0 mx-1 md:mx-3 shadow-xl transition-spacing duration-500 "+(t?"my-1 md:my-3":"-mb-24")},a)},L=a(17),_=function(e){var t=e.escape,a=Object(i.useState)(""),n=Object(o.a)(a,2),r=n[0],s=n[1];return u.a.createElement(u.a.Fragment,null,u.a.createElement(V,{onClose:t}),u.a.createElement(L.b,null,(function(e){return u.a.createElement("form",{className:"pb-4 pt-1 px-6 rounded-b bg-gray-50 text-gray-700",onSubmit:function(t){t.preventDefault(),e.userId&&A.a.setUserName(e.sessionId,e.userId,r).then((function(t){t&&e.setUserState("canVote")}))}},u.a.createElement("div",{className:"text-gray-500 text-sm py-1 italic tracking-wide"},"Invited to ",e.creator.name,"'s session"),u.a.createElement("label",{className:"block m-2"},u.a.createElement("span",{className:"uppercase font-bold text-sm"},"Your name:"),u.a.createElement("div",{className:"py-1 px-2 rounded border border-gray-300 bg-white focus-within:border-blue-light2 w-max-content"},u.a.createElement(l.a,{icon:c.D,className:"mr-2"}),u.a.createElement("input",{className:"px-2 focus:ring-0 border-0 border-l border-gray-300 bg-white focus:border-gray-300 py-0",type:"text",value:r,onChange:function(e){return s(e.target.value)}}))),u.a.createElement("button",{type:"submit",className:"py-1 uppercase tracking-wide text-sm text-gray-50 bg-yellow hover:theme-dark-yellow w-full mt-4 rounded shadow font-bold btn-focus","aria-label":"join session"},"join session"))})))},P=[{icon:c.o,color:"text-blue",borderColor:"border-blue",descText:"I love it!"},{icon:c.z,color:"text-blue-light1",borderColor:"border-blue-light1",descText:"I like it"},{icon:c.t,color:"text-blue-light2",borderColor:"border-blue-light2",descText:"Meh."},{icon:c.n,color:"text-blue-light3",borderColor:"border-blue-light3",descText:"I don't like it"}],z=a.p+"static/media/corner.50f00bff.svg",H=function(e){var t=e.addVote,a=e.currentVote;return"canView"===Object(i.useContext)(L.a).userState?null:u.a.createElement("form",{className:"flex items-center justify-center",onSubmit:function(e){return e.preventDefault()}},u.a.createElement("span",{className:"text-gray-800 tracking-wide font-bold italic uppercase mr-2"},"vote:"),P.map((function(e,n){return u.a.createElement("button",{key:n,className:"p-xs m-xs btn-focus rounded-full",onClick:function(){return t(n)},"aria-label":e.descText,"data-balloon-pos":"down"},u.a.createElement("div",{className:"leading-none bg-gray-50 rounded-full"},u.a.createElement(l.a,{className:e.color,icon:e.icon,size:"2x"})),u.a.createElement("div",{className:a===n?"":"hidden"},u.a.createElement("img",{src:z,className:"absolute top-0 left-0",alt:""}),u.a.createElement("img",{src:z,className:"absolute top-0 right-0 transform rotate-90",alt:""}),u.a.createElement("img",{src:z,className:"absolute bottom-0 right-0 transform rotate-180",alt:""}),u.a.createElement("img",{src:z,className:"absolute bottom-0 left-0 transform -rotate-90",alt:""})))})))},U=a(63);var Q=function(e){var t=e.hours;if(!t||!t[0])return u.a.createElement("div",{className:"text-gray-500 py-2 px-4 rounded my-3 border border-gray-500 italic text-sm"},"No hours available.");var a=["Mon","Tues","Weds","Thurs","Fri","Sat","Sun"].map((function(e){return{day:e,hourStr:new Array}}));return t[0].open.forEach((function(e){return a[e.day].hourStr.push((t=e.start,n=e.end,"".concat(B(t)," - ").concat(B(n))));var t,n})),u.a.createElement("table",null,u.a.createElement("tbody",null,a.map((function(e){return u.a.createElement("tr",{key:e.day},u.a.createElement("th",{className:"text-left py-0 align-top"},e.day),u.a.createElement("td",{className:"py-0 pl-3 whitespace-pre"},e.hourStr.length>0?e.hourStr.join(",\n"):u.a.createElement("span",{className:"italic text-gray-500"},"Closed")))}))))},B=function(e){return"".concat(e.slice(0,2),":").concat(e.slice(2))},W=function(e){var t=function(e){return("00"+e).slice(-2)},a=new Date,n=((a.getDay()-1)%6+6)%6,r=t(a.getHours())+t(a.getMinutes()),s=9999999,o=e.open.filter((function(e){return e.day===n}));if(0===o.length)return"Closed";var c,l=void 0,i=function(e,t){var a;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=Object(U.a)(e))||t&&e&&"number"===typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==a.return||a.return()}finally{if(c)throw s}}}}(o);try{for(i.s();!(c=i.n()).done;){var u=c.value;if(r<u.start){var m=+u.start-+r;m<s&&(l=B(u.start),s=m)}else if(r<u.end)return"Open now"}}catch(d){i.e(d)}finally{i.f()}return l?"Opens at ".concat(l):"Closed"},J=function(e){var t=e.restaurant,a=e.addRestaurant,n=e.vote,r=e.userIdHash,s=e.userId,m=e.sessionId,d=Object(i.useState)(!1),b=Object(o.a)(d,2),f=b[0],p=b[1];return u.a.createElement("div",{className:"p-1 lg:p-2 my-1 max-w-md mx-auto"},t.addedBy&&u.a.createElement("div",{className:"text-xs uppercase tracking-wide text-gray-500 mt-1 mb-2"},"Added by"," ",r===t.addedBy.hashId?"You":t.addedBy.name,r===t.addedBy.hashId&&u.a.createElement("button",{"aria-label":"remove ".concat(t.business.name),onClick:function(){return A.a.removeRestaurant(m||"",s||"",t.business.id)},className:"mx-1 px-2 py-0.5 border border-gray-300 rounded bg-gray-50 hover:bg-red hover:text-gray-50 hover:border-red hover:shadow btn-focus transition-all duration-200"},u.a.createElement(l.a,{icon:c.C,className:"mr-1"}),"remove")),u.a.createElement("div",{className:"flex justify-between items-start"},a,u.a.createElement("div",{className:"flex-1",onClick:function(){return p((function(e){return!e}))}},u.a.createElement("h2",{className:"flex-1 leading-tight font-display italic font-bold text-xl text-gray-800"},t.business.name,t.business.price&&u.a.createElement("span",{className:"ml-2 px-1 pt-1 rounded bg-gray-500 text-gray-50 text-sm whitespace-nowrap"},t.business.price.split("").map((function(e,t){return u.a.createElement(l.a,{icon:c.i,key:t})})))),u.a.createElement("div",{className:"text-gray-500 font-display leading-tight px-3"},t.business.categories.map((function(e){return e.title})).join(", ")),t.business.hours&&t.business.hours[0]&&u.a.createElement("div",{className:"text-gray-500 uppercase font-bold tracking-wide text-sm leading-tight px-3"},u.a.createElement(l.a,{icon:c.h,className:"mr-1"}),W(t.business.hours[0]))),u.a.createElement("button",{className:"flex-initial fa-layers fa-fw fa-2x ml-2 right-0 btn-focus rounded-full",onClick:function(){return p((function(e){return!e}))},"aria-label":f?"hide more info":"show more info"},u.a.createElement(l.a,{className:" text-gray-50",icon:c.e}),u.a.createElement(l.a,{className:" text-yellow",icon:f?c.d:c.c}))),u.a.createElement("div",{className:"pl-3"},t.votes.length>0&&u.a.createElement("div",{className:"my-1"},t.votes.map((function(e,t){return e?u.a.createElement("span",{className:"m-1 border-gray-800 rounded-sm border bg-gray-50 shadow-md whitespace-nowrap"},u.a.createElement("span",{className:"bg-gray-800 text-gray-50 px-1"},u.a.createElement(l.a,{icon:P[t].icon})),u.a.createElement("span",{className:"px-2 text-gray-800"},e)):null}))),a?null:n,f&&u.a.createElement(u.a.Fragment,null,a?n:null,u.a.createElement("div",{className:"flex justify-around mt-2"},u.a.createElement("div",{className:"flex-shrink-0"},u.a.createElement(Q,{hours:t.business.hours})),u.a.createElement("div",{className:"flex-initial ml-2"},u.a.createElement("div",{className:"flex"},u.a.createElement(l.a,{icon:c.s,className:"flex-none mt-1 mr-2"}),u.a.createElement("div",{className:"flex-initial"},t.business.location.display_address.map((function(e){return u.a.createElement("p",null,e)})))),t.business.transactions&&t.business.transactions.length>0&&u.a.createElement("ul",{className:"mt-3"},u.a.createElement("h3",{className:"uppercase tracking-wide font-bold text-gray-500 text-sm"},"Services offered:"),t.business.transactions.map((function(e){return u.a.createElement("li",null,u.a.createElement(l.a,{icon:c.b,className:"mr-2 text-green-500"}),e)}))),u.a.createElement("a",{className:"block text-center rounded w-full py-1 px-3 bg-red text-gray-50 font-bold italic mt-3",href:t.business.url,target:"_blank",rel:"noopener noreferrer"},"more info",u.a.createElement(l.a,{icon:c.l,className:"ml-2"})))))))},Y=function(e){var t=e.voteOnRestaurant,a=e.addedRestaurants,r=Object(i.useContext)(L.a),o=r.previousVotes,c=r.setPreviousVotes,l=r.userIdHash,m=r.userId,d=r.sessionId;return u.a.createElement(u.a.Fragment,null,u.a.createElement("h2",{className:"max-w-md mx-auto text-2xl px-1 text-gray-800 font-display leading-none"},"Restaurants"),0===Object.keys(a).length&&u.a.createElement("div",{className:"text-gray-500 py-2 px-4 rounded my-3 border border-gray-300 italic text-sm mx-auto max-w-md"},"No restaurants have been added"),Object.values(a).map((function(e){return u.a.createElement(J,{key:e.business.id,restaurant:e,vote:u.a.createElement(H,{currentVote:o[e.business.id],addVote:function(a){t(e.business.id,a),c((function(t){return s(s({},t),{},n({},e.business.id,a))}))}}),userIdHash:l,userId:m,sessionId:d})})))},$=a(22);function G(e,t){var a={};return"openDate"===t.key?"any"===t.newVal?(a.openDate="any",a.openNow=!1):a.openDate="today":"openNow"===t.key?(a.openNow=!e.openNow,a.openNow&&(a.openDate="today")):"delivery"===t.key||"pickup"===t.key||"restaurant_reservation"===t.key?a.services=s(s({},e.services),{},n({},t.key,!e.services[t.key])):"price"===t.key&&("number"===typeof e.prices[0]&&"number"===typeof e.prices[1]?a.prices=[t.newVal,void 0]:"number"===typeof e.prices[0]&&(a.prices=[e.prices[0],t.newVal])),s(s({},e),a)}var Z=function(e){var t=e.update,a=e.updateSearchFormState,n=e.searchFormFilterState,r=Object(i.useState)(!1),s=Object(o.a)(r,2),m=s[0],d=s[1],b=Object(i.useReducer)(G,n||{openDate:"any",openNow:!1,prices:[0,3],services:{pickup:!0,delivery:!0,restaurant_reservation:!0}}),f=Object(o.a)(b,2),p=f[0],h=f[1],y=Object($.a)((function(){m&&d(!1)}));Object(i.useEffect)((function(){a({filter:p})}),[p,a]);Object(i.useEffect)((function(){t({openHours:"any"===p.openDate?"any":p.openNow?"now":"today",priceRange:new Array(void 0===p.prices[1]?1:Math.abs(p.prices[0]-p.prices[1])+1).fill(0).map((function(e,t){return function(e){var t=99;return e.forEach((function(e){"number"===typeof e&&e<t&&(t=e)})),t}(p.prices)+1+t})).join(","),services:Object.entries(p.services).filter((function(e){var t=Object(o.a)(e,2);t[0];return t[1]})).map((function(e){var t=Object(o.a)(e,2),a=t[0];t[1];return a})).join(",")})}),[p,t]);var v=new Array(4).fill("").map((function(e,t){return"$".repeat(t+1)}));return u.a.createElement(u.a.Fragment,null,u.a.createElement("button",{type:"button",className:"ml-1 px-2 py-1 text-blue border border-blue bg-gray-50 rounded shadow font-bold text-sm uppercase tracking-wide btn-focus flex-inital whitespace-nowrap",onClick:function(){m||d(!0)},"aria-label":"show filters"},u.a.createElement(l.a,{icon:c.y,className:"mr-2"}),"filters"),u.a.createElement("div",{ref:y,className:"p-2 mt-10 mx-2 absolute border border-gray-300 rounded bg-gray-50 z-40 left-0 right-0 "+(m?"":"hidden")},u.a.createElement("div",{className:"w-full sm:w-1/2"},u.a.createElement("span",{className:"text-sm font-bold uppercase tracking-wide text-gray-500"},"Price Range"),u.a.createElement("div",{className:"group mt-1 ml-2 mb-3 text-sm whitespace-nowrap"},v.map((function(e,t){return u.a.createElement("button",{type:"button",key:t,onClick:function(){return h({key:"price",newVal:t})},className:"relative px-2 btn-focus "+(p.prices.includes(t)?"bg-blue text-gray-50 px-1 py-2 rounded-full z-30 ":"")+(a=t,n=p.prices,"number"===typeof n[0]&&"number"===typeof n[1]&&(n[0]<a&&a<n[1]||n[1]<a&&a<n[0])?"bg-blueGray-light text-gray-800 py-1 px-4 -mx-2 z-20 ":""),"aria-label":"price: ".concat(e)},e);var a,n}))),u.a.createElement("span",{className:"text-sm font-bold uppercase tracking-wide text-gray-500"},"Open Hours"),u.a.createElement("label",{className:"block px-2"},u.a.createElement("input",{className:"mr-1 btn-focus rounded-full text-blue",checked:"any"===p.openDate,type:"radio",name:"day",onChange:function(){return h({newVal:"any",key:"openDate"})}}),"Any time"),u.a.createElement("label",{className:"block px-2"},u.a.createElement("input",{className:"mr-1 btn-focus rounded-full  text-blue",checked:"today"===p.openDate,type:"radio",name:"day",onChange:function(){return h({newVal:"today",key:"openDate"})}}),"Today",u.a.createElement("label",{className:"block px-4 -mt-1 mb-2 "},u.a.createElement("input",{className:"mr-1 btn-focus rounded text-blue",checked:p.openNow,type:"checkbox",onChange:function(){return h({key:"openNow"})}}),"Open now"))),u.a.createElement("div",{className:"w-full sm:w-1/2"},u.a.createElement("span",{className:"text-sm font-bold uppercase tracking-wide text-gray-500"},"Services Offered"),u.a.createElement("label",{className:"block px-2"},u.a.createElement("input",{className:"mr-1 btn-focus  rounded text-blue",checked:p.services.pickup,type:"checkbox",onChange:function(){return h({key:"pickup"})}}),"Pickup"),u.a.createElement("label",{className:"block px-2"},u.a.createElement("input",{className:"mr-1 btn-focus  rounded text-blue",checked:p.services.delivery,type:"checkbox",onChange:function(){return h({key:"delivery"})}}),"Delivery"),u.a.createElement("label",{className:"block px-2"},u.a.createElement("input",{className:"mr-1 btn-focus  rounded text-blue",checked:p.services.restaurant_reservation,type:"checkbox",onChange:function(){return h({key:"restaurant_reservation"})}}),"Restaurant reservation"),u.a.createElement("div",{className:p.services.pickup||p.services.delivery||p.services.restaurant_reservation?"hidden":"mx-6 my-1 bg-gray-50 bg-opacity-50 border-l-4 border-orange-500 px-2 py-1 rounded text-sm italic"},u.a.createElement(l.a,{icon:c.k,className:"text-orange-500 mr-2"}),"Please select at least one service."))))},K=function(e){var t=e.isRestaurantsAdded,a=e.userState,n=e.sessionId,r=e.userId,s=e.businessId,m=Object(i.useState)(!1),d=Object(o.a)(m,2),b=d[0],f=d[1];return u.a.createElement("button",{"aria-label":t?"restaurant has already been added":"canVote"===a?"add restaurant":"you must join the session before adding a restaurant","data-balloon-pos":"right",className:"py-1 px-2 mr-2 md:mr-4 text-gray-600 border border-gray-300 rounded-full group btn-focus shadow bg-gray-50",onClick:function(){t||"canVote"!==a||(f(!0),A.a.addRestaurant(n,r,s).then((function(e){return f(!1)})))}},u.a.createElement(l.a,{className:b?"animate-spin":"",icon:b?c.f:t?c.b:c.v}))},X=a(61),ee=function(e){var t=e.sessionId,a=e.searchInput,n=e.selectItem,r=Object(i.useState)([]),s=Object(o.a)(r,2),c=s[0],l=s[1],m=Object(i.useRef)(),d=Object(i.useRef)();Object(i.useEffect)((function(){a&&m.current!==a&&A.a.autocomplete(t,a).then((function(e){m.current=a,l(e)}))}),[a,t]);var b=Object(i.useCallback)((function(e){d.current=e,n(e)}),[n]);return d.current===a?null:u.a.createElement(X.a,{items:c,updateSelection:b})},te=function(e){var t=e.businesses,a=e.voteOnRestaurant,r=e.isAdded,o=Object(i.useContext)(L.a),c=o.sessionId,l=o.userId,m=o.userState,d=o.previousVotes,b=o.setPreviousVotes;return 0===(null===t||void 0===t?void 0:t.length)?u.a.createElement("div",{className:"uppercase font-bold tracking-wide text-sm text-gray-500 px-6 py-2"},"No results."):u.a.createElement("ul",{className:"divide-y divide-gray-300"},null===t||void 0===t?void 0:t.map((function(e){return u.a.createElement("li",{key:e.id},u.a.createElement(J,{key:e.id,restaurant:{business:e,votes:[]},addRestaurant:u.a.createElement(K,{isRestaurantsAdded:!!r[e.id],userState:m,sessionId:c,userId:l,businessId:e.id}),vote:r[e.id]?u.a.createElement(H,{currentVote:d[e.id],addVote:function(t){a(e.id,t),b((function(a){return s(s({},a),{},n({},e.id,t))}))}}):null}))})))},ae=function(e){var t=e.sessionId,a=e.location,n=e.creator,r=e.userIdHash,s=e.voteOnRestaurant,m=e.isAdded,d=e.searchFormState,b=e.updateSearchFormState,f=Object(i.useState)(d.search||""),p=Object(o.a)(f,2),h=p[0],y=p[1],v=Object(i.useState)(d.results),g=Object(o.a)(v,2),x=g[0],E=g[1],w=Object(i.useState)(!1),N=Object(o.a)(w,2),j=N[0],O=N[1],k=Object(i.useState)(),S=Object(o.a)(k,2),C=S[0],I=S[1],R=Object(i.useCallback)((function(e){I(e)}),[I]);return Object(i.useEffect)((function(){b({search:h,results:x})}),[h,x,b]),u.a.createElement(u.a.Fragment,null,u.a.createElement("h2",{className:"max-w-md mx-auto text-2xl px-1 text-gray-800 font-display leading-none mb-1"},"Search"),u.a.createElement("hr",{className:"border-gray-300"}),u.a.createElement("div",{className:"text-gray-500 italic m-2"},(null===n||void 0===n?void 0:n.hashId)===r?"You":null===n||void 0===n?void 0:n.name," set the location to"," ",u.a.createElement("span",{className:"uppercase text-sm font-bold"},a,u.a.createElement("button",{type:"button","aria-label":"Search results will not be strictly within this area; it serves as a starting point.","data-balloon-pos":"down","data-balloon-length":"medium",className:"btn-focus rounded-full"},u.a.createElement(l.a,{icon:c.q,className:"ml-1"})))),u.a.createElement("form",{className:"p-2 w-full flex relative items-stretch",onSubmit:function(e){e.preventDefault(),O(!0),E(void 0),A.a.search(t,h,(null===C||void 0===C?void 0:C.openHours)||"",(null===C||void 0===C?void 0:C.priceRange)||"",(null===C||void 0===C?void 0:C.services)||"").then((function(e){E(e),O(!1)})).catch((function(e){return console.error("error searching: ".concat(e))}))}},u.a.createElement("div",{className:"flex-1 inline-block"},u.a.createElement("input",{className:"rounded-l py-1 px-2 shadow btn-focus w-full border-y border-l border-gray-300 focus:border-gray-300",type:"search",inputMode:"search",value:h,onChange:function(e){return y(e.target.value)}}),u.a.createElement(ee,{sessionId:t,searchInput:h,selectItem:y})),u.a.createElement("button",{className:"shadow py-1 px-2 text-gray-50 bg-blue rounded-r btn-focus flex-initial",type:"submit","aria-label":"search"},u.a.createElement(l.a,{"aria-label":"search",icon:c.x})),u.a.createElement(Z,{update:R,updateSearchFormState:b,searchFormFilterState:d.filter})),j&&u.a.createElement(l.a,{icon:c.f,size:"5x",className:"animate-spin text-yellow mx-auto my-4 block"}),u.a.createElement(te,{businesses:x,voteOnRestaurant:s,isAdded:m}))};t.default=function(){var e=Object(i.useState)({}),t=Object(o.a)(e,2),a=t[0],r=t[1],m=Object(i.useContext)(L.a),d=m.sessionId,b=m.setSessionId,f=m.userId,p=m.userIdHash,h=m.setUserId,y=m.setUserState,v=m.location,g=m.setLocation,x=m.creator,E=m.setCreator,w=m.setPreviousVotes,N=Object(i.useState)(!1),I=Object(o.a)(N,2),R=I[0],D=I[1],M=Object(i.useState)(!1),V=Object(o.a)(M,2),P=V[0],z=V[1],H=Object(i.useState)(!1),U=Object(o.a)(H,2),Q=U[0],B=U[1],W=Object(i.useState)({}),J=Object(o.a)(W,2),$=J[0],G=J[1],Z=Object(O.g)();Object(i.useEffect)((function(){return A.a.subscribeToRestaurantAdded((function(e){r((function(t){return s(s({},t),{},n({},e.business.id,e))}))})),A.a.subscribeToRestaurantRemoved((function(e){r((function(t){var a=Object.assign({},t);return delete a[e.restaurantId],a})),w((function(t){var a=Object.assign({},t);return delete a[e.restaurantId],a}))})),A.a.subscribeToVoteAdded((function(e){r((function(t){var a=s({},t);return a[e.restaurantId].votes=e.votes,s(s({},t),a)}))})),function(){A.a.unSubscribeToRestaurantAdded(),A.a.unSubscribeToRestaurantRemoved(),A.a.unSubscribeToVoteAdded()}}),[w]);var K=function(e,t){return A.a.addVote(d,f,e,t)},X=Object(i.useCallback)((function(e){return G((function(t){return s(s({},t),e)}))}),[G]),ee=u.a.createElement("div",{className:"flex-1 py-4 px-2 max-w-md w-full mx-auto"},u.a.createElement(ae,{voteOnRestaurant:K,isAdded:a,userIdHash:p,sessionId:d,location:v,creator:x,searchFormState:$,updateSearchFormState:X})),te=u.a.createElement("div",{className:"flex-1 py-4 px-2 max-w-md w-full divide-y divide-gray-300 mx-auto"},u.a.createElement(Y,{voteOnRestaurant:K,addedRestaurants:a}));return Object(i.useEffect)((function(){var e,t;(null===(e=window.history)||void 0===e||null===(t=e.state)||void 0===t?void 0:t.fromLogin)?(B(!0),D(!0),window.history.replaceState({fromLogin:!1},"")):""!==d&&A.a.tryJoinSession({sessionId:d,userId:f},(function(e){e.success?(z(!1),b(d),h(e.userId),y(e.previouslyAuthenticated?"canVote":"canView"),g(e.location),E(e.creator),w(e.previousVotes),r(e.restaurants||{}),D(!0)):(Z.push("/404"),console.error("recieved failure from server"))}))}),[d,Z,E,g,w,b,h,y,f]),u.a.createElement(u.a.Fragment,null,Q&&u.a.createElement(C.a,{shadow:!0,onClose:function(){return B(!1)}},u.a.createElement(q,{onClose:function(){return B(!1)}})),!R&&u.a.createElement(C.a,{shadow:!1,onClose:function(){}},u.a.createElement(l.a,{icon:c.f,size:"5x",className:"animate-spin text-yellow block"})),u.a.createElement(F,{show:P},u.a.createElement("div",{className:"py-2 px-4 bg-gray-100 flex items-center rounded-md border text-sm"},u.a.createElement(l.a,{icon:c.a,className:"flex-initial text-gray-800 p-1 pb-0",size:"3x"}),u.a.createElement("div",{className:"flex-1 pl-3"},u.a.createElement("div",{className:"text-md font-bold border-b border-gray-400 p-1"},"Currently in view-only mode."),u.a.createElement("div",{className:"text-gray-700 leading-tight p-1"},u.a.createElement("span",{className:"border-b border-blue hover:text-blue cursor-pointer",onClick:function(){z(!1)}},"Join the session"),"\xa0 to add restaurants and vote")))),u.a.createElement(L.b,null,(function(e){return u.a.createElement(u.a.Fragment,null,R&&"canVote"!==e.userState&&!P&&u.a.createElement(C.a,{shadow:!0,onClose:function(){return z(!0)}},u.a.createElement(_,{escape:function(){return z(!0)}})),u.a.createElement("header",{className:"bg-red text-gray-50 shadow "},u.a.createElement("nav",{className:"flex justify-between p-2 lg:p-4 lg:px-8"},u.a.createElement(k.b,{to:"/getStarted"},u.a.createElement("img",{className:"text-gray-50 inline-block w-32 lg:w-38 flex-initial",src:S.a,alt:"chew logo"})),u.a.createElement(k.b,{to:"/getStarted",className:"inline-block flex-initial self-center text-sm"},"leave this group ",u.a.createElement(l.a,{icon:c.j}))),u.a.createElement("div",{className:"lg:hidden uppercase font-bold tracking-wide p-2 pb-1 text-sm bg-red-dark"},u.a.createElement(k.c,{to:"/ID/".concat(e.sessionId),exact:!0,className:"p-1 m-1",activeClassName:"border-b-2 border-gray-50"},u.a.createElement(l.a,{icon:c.E,size:"sm",className:"mr-2"}),"view restaurants"),u.a.createElement(k.c,{to:"/ID/".concat(e.sessionId,"/search"),exact:!0,className:"p-1 m-1",activeClassName:"border-b-2 border-gray-50"},u.a.createElement(l.a,{icon:c.x,size:"sm",className:"mr-2"}),"search"))),u.a.createElement("main",{className:"flex-grow"},u.a.createElement(j,{query:"(min-width: 1024px)",render:function(){return u.a.createElement(O.d,null,u.a.createElement(O.b,{path:"/ID/:sessionId",exact:!0,render:function(){return u.a.createElement("div",{className:"flex justify-around px-1 max-w-7xl mx-auto"},te," ",ee)}}),u.a.createElement(O.b,{path:"/",render:function(){return u.a.createElement(O.a,{to:"/ID/".concat(e.sessionId)})}}))}}),u.a.createElement(j,{query:"(max-width: 1023px)",render:function(){return u.a.createElement(O.b,{path:"/ID/:sessionId",render:function(e){e.location;return u.a.createElement(O.d,null,u.a.createElement(O.b,{path:"/ID/:sessionId",exact:!0,render:function(){return te}}),u.a.createElement(O.b,{path:"/ID/:sessionId/search",exact:!0,render:function(){return ee}}))}})}})),u.a.createElement(T,null))})))}}}]);
//# sourceMappingURL=3.8cf7669a.chunk.js.map